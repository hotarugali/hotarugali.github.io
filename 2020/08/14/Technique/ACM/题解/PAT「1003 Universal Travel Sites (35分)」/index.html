<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>PAT「1003 Universal Travel Sites (35分)」 | お前はどこまで見えている</title><meta name="author" content="hotarugali"><meta name="copyright" content="hotarugali"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="1. 题目 题目链接：PAT「1003 Universal Travel Sites (35分)」 。 Description After finishing her tour around the Earth, CYLL is now planning a universal travel sites development project. After a careful investigat">
<meta property="og:type" content="article">
<meta property="og:title" content="PAT「1003 Universal Travel Sites (35分)」">
<meta property="og:url" content="https://hotarugali.github.io/2020/08/14/Technique/ACM/%E9%A2%98%E8%A7%A3/PAT%E3%80%8C1003%20Universal%20Travel%20Sites%20(35%E5%88%86)%E3%80%8D/index.html">
<meta property="og:site_name" content="お前はどこまで見えている">
<meta property="og:description" content="1. 题目 题目链接：PAT「1003 Universal Travel Sites (35分)」 。 Description After finishing her tour around the Earth, CYLL is now planning a universal travel sites development project. After a careful investigat">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://hotarugali.github.io/FigureBed/wallpaper/107.jpg">
<meta property="article:published_time" content="2020-08-14T12:18:00.000Z">
<meta property="article:modified_time" content="2023-12-17T04:14:51.569Z">
<meta property="article:author" content="hotarugali">
<meta property="article:tag" content="Technique">
<meta property="article:tag" content="ACM">
<meta property="article:tag" content="题解">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hotarugali.github.io/FigureBed/wallpaper/107.jpg"><link rel="shortcut icon" href="/img/hotarugali.jpg"><link rel="canonical" href="https://hotarugali.github.io/2020/08/14/Technique/ACM/%E9%A2%98%E8%A7%A3/PAT%E3%80%8C1003%20Universal%20Travel%20Sites%20(35%E5%88%86)%E3%80%8D/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//www.clarity.ms"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?297e40d6e8840f7c1ba9900535589fa1";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-FEG5THRHCZ"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-FEG5THRHCZ');
</script><script>(function(c,l,a,r,i,t,y){
    c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
    t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
    y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
})(window, document, "clarity", "script", "68ocnze3o7");</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":true,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'PAT「1003 Universal Travel Sites (35分)」',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-12-17 12:14:51'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="//at.alicdn.com/t/font_2479343_vob9mc984l.css"><link rel="stylesheet" href="/css/custom.css"  media="defer" onload="this.media='all'"><link rel="stylesheet" href="/css/botui.css"><style type="text/css">.app-refresh{position:fixed;top:-2.2rem;left:0;right:0;z-index:99999;padding:0 1rem;font-size:15px;height:2.2rem;transition:all .3s ease}.app-refresh-wrap{display:flex;color:#fff;height:100%;align-items:center;justify-content:center}.app-refresh-wrap a{color:#fff;text-decoration:underline;cursor:pointer}</style><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-card-history/baiduhistory/css/main.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/hexo-electric-clock@1.0.6/clock.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-electric-clock-plus@latest/css/clock.css"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.0.0"><link rel="alternate" href="/atom.xml" title="お前はどこまで見えている" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>const preloader = {
  endLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = 'hidden';
    document.getElementById('loading-box').classList.remove("loaded")
  }
}

preloader.initLoading()
window.addEventListener('load',()=> { preloader.endLoading() })

if (false) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/hotarugali.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">529</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">161</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">155</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw iconfont icon-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw iconfont icon-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw iconfont icon-label"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw iconfont icon-Category"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw iconfont icon-list"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/shuoshuo/"><i class="fa-fw iconfont icon-book"></i><span> 说说</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw iconfont icon-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/bangumis/"><i class="fa-fw iconfont icon-love"></i><span> 番剧</span></a></li><li><a class="site-page child" href="/comment/"><i class="fa-fw iconfont icon-message"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw iconfont icon-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/fcircle/"><i class="fa-fw iconfont icon-f-circle"></i><span> 朋友圈</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw iconfont icon-person1"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://hotarugali.github.io/FigureBed/wallpaper/107.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="お前はどこまで見えている"><span class="site-name">お前はどこまで見えている</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw iconfont icon-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw iconfont icon-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw iconfont icon-label"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw iconfont icon-Category"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw iconfont icon-list"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/shuoshuo/"><i class="fa-fw iconfont icon-book"></i><span> 说说</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw iconfont icon-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/bangumis/"><i class="fa-fw iconfont icon-love"></i><span> 番剧</span></a></li><li><a class="site-page child" href="/comment/"><i class="fa-fw iconfont icon-message"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw iconfont icon-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/fcircle/"><i class="fa-fw iconfont icon-f-circle"></i><span> 朋友圈</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw iconfont icon-person1"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">PAT「1003 Universal Travel Sites (35分)」</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-08-14T12:18:00.000Z" title="发表于 2020-08-14 20:18:00">2020-08-14</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-12-17T04:14:51.569Z" title="更新于 2023-12-17 12:14:51">2023-12-17</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Technique/">Technique</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Technique/ACM/">ACM</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Technique/ACM/%E9%A2%98%E8%A7%A3/">题解</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">3.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>17分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="PAT「1003 Universal Travel Sites (35分)」"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="1-题目">1. 题目</h2>
<p>题目链接：<a target="_blank" rel="noopener" href="https://pintia.cn/problem-sets/994805148990160896/problems/994805155688464384">PAT「1003 Universal Travel Sites (35分)」</a> 。</p>
<h3 id="Description">Description</h3>
<p>After finishing her tour around the Earth, CYLL is now planning a universal travel sites development project. After a careful investigation, she has a list of capacities of all the satellite transportation stations in hand. To estimate a budget, she must know the minimum capacity that a planet station must have to guarantee that every space vessel can dock and download its passengers on arrival.</p>
<h3 id="Input-Specification">Input Specification:</h3>
<p>Each input file contains one test case. For each case, the first line contains the names of the source and the destination planets, and a positive integer <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≤</mo><mn>500</mn></mrow><annotation encoding="application/x-tex">\leq 500</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">500</span></span></span></span>). Then <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> lines follow, each in the format: <code>source[i]</code> <code>destination[i]</code> <code>capacity[i]</code> where <code>source[i]</code> and <code>destination[i]</code> are the names of the satellites and the two involved planets, and <code>capacity[i]</code> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">&gt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> is the maximum number of passengers that can be transported at one pass from <code>source[i]</code> to <code>destination[i]</code>. Each name is a string of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn></mrow><annotation encoding="application/x-tex">3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span> uppercase characters chosen from <code>&#123;A-Z&#125;</code>, e.g., <code>ZJU</code>.</p>
<p>Note that the satellite transportation stations have no accommodation facilities for the passengers. Therefore none of the passengers can stay. Such a station will not allow arrivals of space vessels that contain more than its own capacity. It is guaranteed that the list contains neither the routes to the source planet nor that from the destination planet.</p>
<h3 id="Output-Specification">Output Specification:</h3>
<p>For each test case, just print in one line the minimum capacity that a planet station must have to guarantee that every space vessel can dock and download its passengers on arrival.</p>
<h3 id="Sample-Input">Sample Input:</h3>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">EAR MAR <span class="number">11</span></span><br><span class="line">EAR AAA <span class="number">300</span></span><br><span class="line">EAR BBB <span class="number">400</span></span><br><span class="line">AAA BBB <span class="number">100</span></span><br><span class="line">AAA CCC <span class="number">400</span></span><br><span class="line">AAA MAR <span class="number">300</span></span><br><span class="line">BBB DDD <span class="number">400</span></span><br><span class="line">AAA DDD <span class="number">400</span></span><br><span class="line">DDD AAA <span class="number">100</span></span><br><span class="line">CCC MAR <span class="number">400</span></span><br><span class="line">DDD CCC <span class="number">200</span></span><br><span class="line">DDD MAR <span class="number">300</span></span><br></pre></td></tr></table></figure>
<h3 id="Sample-Output">Sample Output:</h3>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">700</span></span><br></pre></td></tr></table></figure>
<h2 id="2-题解">2. 题解</h2>
<h3 id="分析">分析</h3>
<p>很明显的一道网络流题，可以直接上网络流的板子，但是蒟蒻的我，竟然把网络流的板子给忘了，连带那些算法也想不起来了 :( 真菜。只好暴力推流。从起始节点开始，对每个节点的出边使用 dfs 向其后续节点推流，直到推到终止节点，对于当前节点推不过去的流量要返还给父节点。由于可能有环，所以需要对每个节点进行标记，如果当前节点在当前一次推流过程中被访问过，就标记以下，如果推流结束（即逆向返还剩余流时）就取消标记。最终暴力 AC（这都没有 TLE，PAT 上的测试数据真的太弱了！）。</p>
<h3 id="代码">代码</h3>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">505</span>, INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"></span><br><span class="line">unordered_map &lt; string, <span class="type">int</span> &gt; ump;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 前向星存边</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> &#123;</span><br><span class="line">    <span class="type">int</span> to, next, capability;</span><br><span class="line">&#125;edge;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">int</span> len_e;</span><br><span class="line"><span class="type">int</span> c[MAXN];</span><br><span class="line"><span class="type">int</span> h[MAXN];</span><br><span class="line"><span class="type">int</span> f[MAXN];</span><br><span class="line">edge e[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 初始化节点</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = n<span class="number">-1</span>; ~i; --i) &#123;</span><br><span class="line">        h[i] = <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 新增边</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">    e[len_e].next = h[x];</span><br><span class="line">    e[len_e].to = y;</span><br><span class="line">    e[len_e].capability = v;</span><br><span class="line">    h[x] = len_e++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 推流</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">update</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = h[x]; i != <span class="number">-1</span> &amp;&amp; v; i = e[i].next) &#123;</span><br><span class="line">        <span class="keyword">if</span>(f[e[i].to] || e[i].capability == <span class="number">0</span>)    <span class="keyword">continue</span>;</span><br><span class="line">        f[e[i].to] = <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> s, t;</span><br><span class="line">        <span class="keyword">if</span>(e[i].capability &gt;= v) &#123;</span><br><span class="line">            s = <span class="built_in">update</span>(e[i].to, v);</span><br><span class="line">            t = v-s;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            s = <span class="built_in">update</span>(e[i].to, e[i].capability);</span><br><span class="line">            t = e[i].capability-s;</span><br><span class="line">        &#125;</span><br><span class="line">        v -= t;</span><br><span class="line">        c[e[i].to] += t;</span><br><span class="line">        e[i].capability -= t;</span><br><span class="line">        f[e[i].to] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> v;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">answer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    c[<span class="number">0</span>] = INF;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = h[<span class="number">0</span>]; i != <span class="number">-1</span>; i = e[i].next) &#123;</span><br><span class="line">        <span class="built_in">memset</span>(f, <span class="number">0</span>, <span class="built_in">sizeof</span>(f));</span><br><span class="line">        f[e[i].to] = <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> s = <span class="built_in">update</span>(e[i].to, e[i].capability);</span><br><span class="line">        <span class="type">int</span> t = e[i].capability - s;</span><br><span class="line">        c[e[i].to] += t;</span><br><span class="line">        e[i].capability -= t; </span><br><span class="line">        f[e[i].to] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> c[<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">char</span> s[<span class="number">4</span>], t[<span class="number">4</span>];</span><br><span class="line">    <span class="type">int</span> m;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s%s%d&quot;</span>, s, t, &amp;m);</span><br><span class="line">    ump[s] = n++;</span><br><span class="line">    ump[t] = n++;</span><br><span class="line">    <span class="built_in">init</span>(MAXN);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = m; i; --i) &#123;</span><br><span class="line">        <span class="type">char</span> ts[<span class="number">4</span>], tv[<span class="number">4</span>];</span><br><span class="line">        <span class="type">int</span> tst, tvt, cap;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s%s%d&quot;</span>, ts, tv, &amp;cap);</span><br><span class="line">        <span class="keyword">if</span>(ump.<span class="built_in">count</span>(ts) == <span class="number">0</span>) &#123;</span><br><span class="line">            ump[ts] = n++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(ump.<span class="built_in">count</span>(tv) == <span class="number">0</span>) &#123;</span><br><span class="line">            ump[tv] = n++;</span><br><span class="line">        &#125;</span><br><span class="line">        tst = ump[ts];</span><br><span class="line">        tvt = ump[tv];</span><br><span class="line">        <span class="built_in">add</span>(tst, tvt, cap);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">answer</span>());</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="附录">附录</h3>
<ul>
<li>
<h4 id="Dinic-算法">Dinic 算法</h4>
</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Dinic 算法</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Dinic</span> &#123;</span><br><span class="line">    <span class="meta">#<span class="keyword">ifndef</span> _DINIC_</span></span><br><span class="line">    <span class="meta">#<span class="keyword">define</span> ll long long </span></span><br><span class="line">    <span class="meta">#<span class="keyword">define</span> MAXN 1505</span></span><br><span class="line">    <span class="meta">#<span class="keyword">define</span> MAXM 1505</span></span><br><span class="line">    <span class="meta">#<span class="keyword">define</span> INF 1e12</span></span><br><span class="line">    <span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    </span><br><span class="line">    ll cnt_edge;    <span class="comment">// 边数</span></span><br><span class="line">    ll head[MAXN];  <span class="comment">// 节点的第一条边的编号</span></span><br><span class="line">    ll shead[MAXN]; <span class="comment">// shead 用来临时保存 head 的副本</span></span><br><span class="line">    ll level[MAXN]; <span class="comment">// 节点所在层次</span></span><br><span class="line">    <span class="comment">// 链式前向星</span></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">edge</span> &#123;</span><br><span class="line">        ll to, next, flow; <span class="comment">// 分别代表：边的终点、同起点的下一条边的编号、边的流量</span></span><br><span class="line">        <span class="built_in">edge</span>() &#123;&#125;</span><br><span class="line">        <span class="built_in">edge</span>(ll _to, ll _next, ll _flow): <span class="built_in">to</span>(_to), <span class="built_in">next</span>(_next), <span class="built_in">flow</span>(_flow) &#123;&#125;</span><br><span class="line">    &#125;e[MAXM];       <span class="comment">// 边数组 </span></span><br><span class="line">    <span class="built_in">Dinic</span>() &#123;&#125;</span><br><span class="line">    <span class="comment">// 初始化前向星结构</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(ll n)</span> </span>&#123;</span><br><span class="line">        cnt_edge = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">memset</span>(head, <span class="number">-1</span>, <span class="built_in">sizeof</span>(ll)*(n+<span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 添加边（正反向两条边）</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addEdge</span><span class="params">(ll u, ll v, ll w)</span> </span>&#123;</span><br><span class="line">        e[cnt_edge].to = v;</span><br><span class="line">        e[cnt_edge].next = head[u];</span><br><span class="line">        e[cnt_edge].flow = w;</span><br><span class="line">        head[u] = cnt_edge++;</span><br><span class="line">        e[cnt_edge].to = u;</span><br><span class="line">        e[cnt_edge].next = head[v];</span><br><span class="line">        e[cnt_edge].flow = <span class="number">0</span>;</span><br><span class="line">        head[v] = cnt_edge++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// BFS 寻找增广路，构建层次网络</span></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">bfs</span><span class="params">(ll s, ll t, ll n)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">memset</span>(level, <span class="number">0</span>, <span class="built_in">sizeof</span>(ll)*(n+<span class="number">1</span>));</span><br><span class="line">        queue &lt;ll&gt; bfsq;</span><br><span class="line">        bfsq.<span class="built_in">push</span>(s);</span><br><span class="line">        level[s] = <span class="number">1</span>;   <span class="comment">// 0 用来表示没有 bfs 到，故源点深度从 1 开始</span></span><br><span class="line">        <span class="keyword">while</span>(!bfsq.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            ll u = bfsq.<span class="built_in">front</span>();</span><br><span class="line">            bfsq.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">for</span>(ll i = head[u]; i != <span class="number">-1</span>; i = e[i].next) &#123;</span><br><span class="line">                ll v = e[i].to, w = e[i].flow;</span><br><span class="line">                <span class="keyword">if</span>(!level[v] &amp;&amp; w) &#123;</span><br><span class="line">                    level[v] = level[u] + <span class="number">1</span>;</span><br><span class="line">                    bfsq.<span class="built_in">push</span>(v);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(level[t])    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// DFS 进行路径增广</span></span><br><span class="line">    <span class="function">ll <span class="title">dfs</span><span class="params">(ll u, ll curflow, ll t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(u == t) &#123;</span><br><span class="line">            <span class="keyword">return</span> curflow;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(ll &amp; i = shead[u]; i != <span class="number">-1</span>; i = e[i].next) &#123;</span><br><span class="line">            ll v = e[i].to, w = e[i].flow;</span><br><span class="line">            <span class="keyword">if</span>(level[v] == level[u] + <span class="number">1</span> &amp;&amp; w) &#123;</span><br><span class="line">                ll maxflow = <span class="built_in">dfs</span>(v, <span class="built_in">min</span>(curflow, w), t);</span><br><span class="line">                <span class="keyword">if</span>(maxflow) &#123;</span><br><span class="line">                    e[i].flow -= maxflow;</span><br><span class="line">                    e[i^<span class="number">1</span>].flow += maxflow;</span><br><span class="line">                    <span class="keyword">return</span> maxflow;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 求最大流</span></span><br><span class="line">    <span class="function">ll <span class="title">maxFlow</span><span class="params">(ll s, ll t, ll n)</span> </span>&#123;</span><br><span class="line">        ll ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(<span class="built_in">bfs</span>(s,t,n)) &#123;</span><br><span class="line">            ll maxflow = INF, curflow;</span><br><span class="line">            <span class="built_in">memcpy</span>(shead, head, <span class="built_in">sizeof</span>(head));</span><br><span class="line">            <span class="keyword">while</span>((curflow = <span class="built_in">dfs</span>(s, maxflow, t))) &#123;</span><br><span class="line">                ans += curflow;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">unordered_map &lt; string, <span class="type">int</span> &gt; ump;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Dinic dinic;</span><br><span class="line">    <span class="type">char</span> s[<span class="number">4</span>], t[<span class="number">4</span>];</span><br><span class="line">    <span class="type">int</span> n = <span class="number">1</span>, m = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s%s%d&quot;</span>, s, t, &amp;m);</span><br><span class="line">    ump[s] = n++;</span><br><span class="line">    ump[t] = n++;</span><br><span class="line">    </span><br><span class="line">    dinic.<span class="built_in">init</span>(MAXN<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = m; i; --i) &#123;</span><br><span class="line">        <span class="type">char</span> ts[<span class="number">4</span>], tv[<span class="number">4</span>];</span><br><span class="line">        <span class="type">int</span> tst, tvt, cap;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s%s%d&quot;</span>, ts, tv, &amp;cap);</span><br><span class="line">        <span class="keyword">if</span>(ump.<span class="built_in">count</span>(ts) == <span class="number">0</span>) &#123;</span><br><span class="line">            ump[ts] = n++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(ump.<span class="built_in">count</span>(tv) == <span class="number">0</span>) &#123;</span><br><span class="line">            ump[tv] = n++;</span><br><span class="line">        &#125;</span><br><span class="line">        tst = ump[ts];</span><br><span class="line">        tvt = ump[tv];</span><br><span class="line">        dinic.<span class="built_in">addEdge</span>(tst, tvt, cap);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, dinic.<span class="built_in">maxFlow</span>(ump[s],ump[t],n));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>
<h4 id="ISAP-算法">ISAP 算法</h4>
</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ISAP 算法</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ISAP</span> &#123;</span><br><span class="line">    <span class="meta">#<span class="keyword">ifndef</span> _ISAP_</span></span><br><span class="line">    <span class="meta">#<span class="keyword">define</span> ll long long </span></span><br><span class="line">    <span class="meta">#<span class="keyword">define</span> MAXN 1205</span></span><br><span class="line">    <span class="meta">#<span class="keyword">define</span> MAXM 1205</span></span><br><span class="line">    <span class="meta">#<span class="keyword">define</span> INF 1e12</span></span><br><span class="line">    <span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    </span><br><span class="line">    ll cnt_edge;    <span class="comment">// 边数</span></span><br><span class="line">    ll head[MAXN];  <span class="comment">// 节点的第一条边的编号</span></span><br><span class="line">    ll shead[MAXN]; <span class="comment">// shead 用来临时保存 head 的副本</span></span><br><span class="line">    ll level[MAXN]; <span class="comment">// 节点所在层次</span></span><br><span class="line">    ll gap[MAXN+<span class="number">1</span>];   <span class="comment">// 层次节点数</span></span><br><span class="line">    <span class="comment">// 链式前向星</span></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">edge</span> &#123;</span><br><span class="line">        ll to, next, flow; <span class="comment">// 分别代表：边的终点、同起点的下一条边的编号、边的流量</span></span><br><span class="line">        <span class="built_in">edge</span>() &#123;&#125;</span><br><span class="line">        <span class="built_in">edge</span>(ll _to, ll _next, ll _flow): <span class="built_in">to</span>(_to), <span class="built_in">next</span>(_next), <span class="built_in">flow</span>(_flow) &#123;&#125;</span><br><span class="line">    &#125;e[MAXM];       <span class="comment">// 边数组 </span></span><br><span class="line">    <span class="built_in">ISAP</span>() &#123;&#125;</span><br><span class="line">    <span class="comment">// 初始化前向星结构</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(ll n)</span> </span>&#123;</span><br><span class="line">        cnt_edge = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">memset</span>(head, <span class="number">-1</span>, <span class="built_in">sizeof</span>(ll)*(n+<span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 添加边（正反向两条边）</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addEdge</span><span class="params">(ll u, ll v, ll w)</span> </span>&#123;</span><br><span class="line">        e[cnt_edge].to = v;</span><br><span class="line">        e[cnt_edge].next = head[u];</span><br><span class="line">        e[cnt_edge].flow = w;</span><br><span class="line">        head[u] = cnt_edge++;</span><br><span class="line">        e[cnt_edge].to = u;</span><br><span class="line">        e[cnt_edge].next = head[v];</span><br><span class="line">        e[cnt_edge].flow = <span class="number">0</span>;</span><br><span class="line">        head[v] = cnt_edge++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// BFS 寻找增广路，构建层次网络</span></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">bfs</span><span class="params">(ll s, ll t, ll n)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">memset</span>(level, <span class="number">0</span>, <span class="built_in">sizeof</span>(ll)*(n+<span class="number">1</span>));</span><br><span class="line">        <span class="built_in">memset</span>(gap, <span class="number">0</span>, <span class="built_in">sizeof</span>(ll)*(n+<span class="number">2</span>));   <span class="comment">// 最大 level 可达 n+1（见下文）</span></span><br><span class="line">        queue &lt;ll&gt; bfsq;</span><br><span class="line">        level[t] = <span class="number">1</span>;   <span class="comment">// 0 用来表示没有 bfs 到，故到汇点的距离从 1 开始</span></span><br><span class="line">        gap[<span class="number">1</span>] = <span class="number">1</span>;    </span><br><span class="line">        bfsq.<span class="built_in">push</span>(t); </span><br><span class="line">        <span class="keyword">while</span>(!bfsq.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            ll u = bfsq.<span class="built_in">front</span>();</span><br><span class="line">            bfsq.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">for</span>(ll i = head[u]; i != <span class="number">-1</span>; i = e[i].next) &#123;</span><br><span class="line">                <span class="comment">// 在反图中构建层次网络，故需反向判断路径容量</span></span><br><span class="line">                ll v = e[i].to;</span><br><span class="line">                <span class="keyword">if</span>(!level[v] &amp;&amp; e[i^<span class="number">1</span>].flow) &#123;</span><br><span class="line">                    level[v] = level[u] + <span class="number">1</span>;</span><br><span class="line">                    ++gap[level[v]];</span><br><span class="line">                    bfsq.<span class="built_in">push</span>(v);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 判断 s 到 t 是否有增广路</span></span><br><span class="line">        <span class="keyword">if</span>(level[s])    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 重贴标签（更新层次深度）</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">relabel</span><span class="params">(ll u, ll n)</span> </span>&#123;</span><br><span class="line">        level[u] = n + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(ll i = head[u]; i != <span class="number">-1</span>; i = e[i].next) &#123;</span><br><span class="line">            ll v = e[i].to, w = e[i].flow;</span><br><span class="line">            <span class="keyword">if</span>(level[v] &lt; level[u] - <span class="number">1</span> &amp;&amp; w) &#123;</span><br><span class="line">                level[u] = level[v] + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// DFS 进行路径增广</span></span><br><span class="line">    <span class="function">ll <span class="title">dfs</span><span class="params">(ll u, ll curflow, ll s, ll t, ll n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(u == t) &#123;</span><br><span class="line">            <span class="keyword">return</span> curflow;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(ll &amp; i = shead[u]; i != <span class="number">-1</span>; i = e[i].next) &#123;</span><br><span class="line">            ll v = e[i].to, w = e[i].flow;</span><br><span class="line">            <span class="keyword">if</span>(level[v] == level[u] - <span class="number">1</span> &amp;&amp; w) &#123;</span><br><span class="line">                ll maxflow = <span class="built_in">dfs</span>(v, <span class="built_in">min</span>(curflow, w), s, t, n);</span><br><span class="line">                <span class="keyword">if</span>(maxflow) &#123;</span><br><span class="line">                    e[i].flow -= maxflow;</span><br><span class="line">                    e[i^<span class="number">1</span>].flow += maxflow;</span><br><span class="line">                    <span class="keyword">return</span> maxflow;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 程序执行到此说明该点出去的所有点都已经流过了</span></span><br><span class="line">        <span class="comment">// 此时需要更改层次深度</span></span><br><span class="line">        <span class="comment">// 同样要更新对应点的 shead</span></span><br><span class="line">        shead[u] = head[u];</span><br><span class="line">        --gap[level[u]];</span><br><span class="line">        <span class="keyword">if</span>(gap[level[u]] == <span class="number">0</span>) &#123;</span><br><span class="line">            level[s] = n + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 提高当前层次深度（因为可能存在路径更长的增广）</span></span><br><span class="line">        <span class="comment">// 方案一：直接更新为出边的最小层次深度+1</span></span><br><span class="line">        <span class="built_in">relabel</span>(u, n);</span><br><span class="line">        <span class="comment">// 方案二：直接更新为原层次深度+1</span></span><br><span class="line">        <span class="comment">// ++level[u];</span></span><br><span class="line">        ++gap[level[u]];</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 求最大流</span></span><br><span class="line">    <span class="function">ll <span class="title">maxFlow</span><span class="params">(ll s, ll t, ll n)</span> </span>&#123;</span><br><span class="line">        ll ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">bfs</span>(s,t,n)) &#123;</span><br><span class="line">            ll maxflow = INF;</span><br><span class="line">            <span class="built_in">memcpy</span>(shead, head, <span class="built_in">sizeof</span>(head));</span><br><span class="line">            <span class="keyword">while</span>(level[s] &lt;= n) &#123;</span><br><span class="line">                ans += <span class="built_in">dfs</span>(s, maxflow, s, t, n);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">unordered_map &lt; string, <span class="type">int</span> &gt; ump;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ISAP isap;</span><br><span class="line">    <span class="type">char</span> s[<span class="number">4</span>], t[<span class="number">4</span>];</span><br><span class="line">    <span class="type">int</span> n = <span class="number">1</span>, m = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s%s%d&quot;</span>, s, t, &amp;m);</span><br><span class="line">    ump[s] = n++;</span><br><span class="line">    ump[t] = n++;</span><br><span class="line">    </span><br><span class="line">    isap.<span class="built_in">init</span>(MAXN<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = m; i; --i) &#123;</span><br><span class="line">        <span class="type">char</span> ts[<span class="number">4</span>], tv[<span class="number">4</span>];</span><br><span class="line">        <span class="type">int</span> tst, tvt, cap;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s%s%d&quot;</span>, ts, tv, &amp;cap);</span><br><span class="line">        <span class="keyword">if</span>(ump.<span class="built_in">count</span>(ts) == <span class="number">0</span>) &#123;</span><br><span class="line">            ump[ts] = n++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(ump.<span class="built_in">count</span>(tv) == <span class="number">0</span>) &#123;</span><br><span class="line">            ump[tv] = n++;</span><br><span class="line">        &#125;</span><br><span class="line">        tst = ump[ts];</span><br><span class="line">        tvt = ump[tv];</span><br><span class="line">        isap.<span class="built_in">addEdge</span>(tst, tvt, cap);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, isap.<span class="built_in">maxFlow</span>(ump[s],ump[t],n));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>
<h4 id="HLPP-算法">HLPP 算法</h4>
</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="comment">// HLPP 算法</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">HLPP</span> &#123;</span><br><span class="line">    <span class="meta">#<span class="keyword">ifndef</span> _HLPP_</span></span><br><span class="line">    <span class="meta">#<span class="keyword">define</span> ll long long </span></span><br><span class="line">    <span class="meta">#<span class="keyword">define</span> MAXN 1205</span></span><br><span class="line">    <span class="meta">#<span class="keyword">define</span> MAXM 1205</span></span><br><span class="line">    <span class="meta">#<span class="keyword">define</span> INF 1e12</span></span><br><span class="line">    <span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    </span><br><span class="line">    ll cnt_edge;    <span class="comment">// 边数</span></span><br><span class="line">    ll head[MAXN];  <span class="comment">// 节点的第一条边的编号</span></span><br><span class="line">    ll rflow[MAXN]; <span class="comment">// 每个点对应的余流（所有节点的余流初始化为0）</span></span><br><span class="line">    ll level[MAXN]; <span class="comment">// 节点所在层次</span></span><br><span class="line">    ll flag[MAXN];  <span class="comment">// 标记是否已经在层次深度链表数组中</span></span><br><span class="line">    ll gap[MAXN&lt;&lt;<span class="number">1</span>];        <span class="comment">// 层次节点数，重贴标签后层次深度可能达到 2n</span></span><br><span class="line">    <span class="comment">// 层次深度结构体</span></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">depth</span> &#123;</span><br><span class="line">        ll node;    <span class="comment">// 节点编号</span></span><br><span class="line">        ll level;   <span class="comment">// 节点层次深度</span></span><br><span class="line">        <span class="built_in">depth</span>() &#123;&#125;</span><br><span class="line">        <span class="built_in">depth</span>(ll _node, ll _level): <span class="built_in">node</span>(_node), <span class="built_in">level</span>(_level) &#123;&#125;</span><br><span class="line">        <span class="type">bool</span> <span class="keyword">operator</span> &lt; (<span class="type">const</span> depth d) <span class="type">const</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> level &lt; d.level;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// 层次深度优先队列</span></span><br><span class="line">    priority_queue &lt;depth&gt; pq;</span><br><span class="line">    <span class="comment">// 链式前向星</span></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">edge</span> &#123;</span><br><span class="line">        ll to, next, flow; <span class="comment">// 分别代表：边的终点、同起点的下一条边的编号、边的流量</span></span><br><span class="line">        <span class="built_in">edge</span>() &#123;&#125;</span><br><span class="line">        <span class="built_in">edge</span>(ll _to, ll _next, ll _flow): <span class="built_in">to</span>(_to), <span class="built_in">next</span>(_next), <span class="built_in">flow</span>(_flow) &#123;&#125;</span><br><span class="line">    &#125;e[MAXM];       <span class="comment">// 边数组 </span></span><br><span class="line">    <span class="built_in">HLPP</span>() &#123;&#125;</span><br><span class="line">    <span class="comment">// 初始化前向星结构</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(ll n)</span> </span>&#123;</span><br><span class="line">        cnt_edge = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">memset</span>(head, <span class="number">-1</span>, <span class="built_in">sizeof</span>(ll)*(n+<span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 添加边（正反向两条边）</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addEdge</span><span class="params">(ll u, ll v, ll w)</span> </span>&#123;</span><br><span class="line">        e[cnt_edge].to = v;</span><br><span class="line">        e[cnt_edge].next = head[u];</span><br><span class="line">        e[cnt_edge].flow = w;</span><br><span class="line">        head[u] = cnt_edge++;</span><br><span class="line">        e[cnt_edge].to = u;</span><br><span class="line">        e[cnt_edge].next = head[v];</span><br><span class="line">        e[cnt_edge].flow = <span class="number">0</span>;</span><br><span class="line">        head[v] = cnt_edge++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// BFS 寻找增广路，构建层次网络（反向构建）</span></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">bfs</span><span class="params">(ll s, ll t, ll n)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">memset</span>(level, <span class="number">0</span>, <span class="built_in">sizeof</span>(ll)*(n+<span class="number">1</span>));</span><br><span class="line">        queue &lt;ll&gt; bfsq;</span><br><span class="line">        level[t] = <span class="number">1</span>;   <span class="comment">// 0 用来表示没有 bfs 到，故到汇点的距离从 1 开始</span></span><br><span class="line">        bfsq.<span class="built_in">push</span>(t); </span><br><span class="line">        <span class="keyword">while</span>(!bfsq.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            ll u = bfsq.<span class="built_in">front</span>();</span><br><span class="line">            bfsq.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">for</span>(ll i = head[u]; i != <span class="number">-1</span>; i = e[i].next) &#123;</span><br><span class="line">                <span class="comment">// 在反图中构建层次网络，故需反向判断路径容量</span></span><br><span class="line">                ll v = e[i].to;</span><br><span class="line">                <span class="keyword">if</span>(!level[v] &amp;&amp; e[i^<span class="number">1</span>].flow) &#123;</span><br><span class="line">                    level[v] = level[u] + <span class="number">1</span>;</span><br><span class="line">                    bfsq.<span class="built_in">push</span>(v);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 判断 s 到 t 是否有增广路</span></span><br><span class="line">        <span class="keyword">if</span>(level[s])    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 预流推进</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">preflowPush</span><span class="params">(ll u, ll s, ll t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(ll i = head[u]; i != <span class="number">-1</span>; i = e[i].next) &#123;</span><br><span class="line">            ll v = e[i].to, w = e[i].flow;</span><br><span class="line">            <span class="keyword">if</span>(level[v] == level[u] - <span class="number">1</span> &amp;&amp; w) &#123;</span><br><span class="line">                ll maxflow = <span class="built_in">min</span>(rflow[u], e[i].flow);</span><br><span class="line">                e[i].flow -= maxflow;</span><br><span class="line">                e[i^<span class="number">1</span>].flow += maxflow;</span><br><span class="line">                rflow[u] -= maxflow;</span><br><span class="line">                rflow[v] += maxflow;</span><br><span class="line">                <span class="keyword">if</span>(v != s &amp;&amp; v != t &amp;&amp; !flag[v]) &#123;</span><br><span class="line">                    pq.<span class="built_in">push</span>(depth&#123;v, level[v]&#125;);</span><br><span class="line">                    flag[v] = <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(rflow[u] == <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="comment">// 全部流量推送完毕</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 重贴标签（更新层次深度）</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">relabel</span><span class="params">(ll u, ll n)</span> </span>&#123;</span><br><span class="line">        level[u] = <span class="number">2</span>*n;</span><br><span class="line">        <span class="keyword">for</span>(ll i = head[u]; i != <span class="number">-1</span>; i = e[i].next) &#123;</span><br><span class="line">            ll v = e[i].to, w = e[i].flow;</span><br><span class="line">            <span class="keyword">if</span>(level[v] &lt; level[u] - <span class="number">1</span> &amp;&amp; w) &#123;</span><br><span class="line">                level[u] = level[v] + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 求最大流</span></span><br><span class="line">    <span class="function">ll <span class="title">maxFlow</span><span class="params">(ll s, ll t, ll n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="built_in">bfs</span>(s,t,n)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 防止s的临近节点过早的推流回s节点</span></span><br><span class="line">        level[s] = n + <span class="number">1</span>;</span><br><span class="line">        <span class="comment">// 初始化 gap 数组</span></span><br><span class="line">        <span class="built_in">memset</span>(gap, <span class="number">0</span>, <span class="built_in">sizeof</span>(ll)*((n+<span class="number">1</span>)&lt;&lt;<span class="number">1</span>));</span><br><span class="line">        <span class="keyword">for</span>(ll i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span>(level[i]) &#123;</span><br><span class="line">                ++gap[level[i]];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 设定源点 s 的出边节点初始余流</span></span><br><span class="line">        <span class="keyword">for</span>(ll i = head[s]; i != <span class="number">-1</span>; i = e[i].next) &#123;</span><br><span class="line">            ll v = e[i].to, w = e[i].flow;</span><br><span class="line">            <span class="keyword">if</span>(w) &#123;</span><br><span class="line">                e[i].flow -= w;</span><br><span class="line">                e[i^<span class="number">1</span>].flow += w;</span><br><span class="line">                rflow[s] -= w;</span><br><span class="line">                rflow[v] += w;</span><br><span class="line">                <span class="keyword">if</span>(v != s &amp;&amp; v != t &amp;&amp; !flag[v]) &#123;</span><br><span class="line">                    pq.<span class="built_in">push</span>(depth&#123;v, level[v]&#125;);</span><br><span class="line">                    flag[v] = <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 开始从最高高度节点预推流</span></span><br><span class="line">        <span class="keyword">while</span>(!pq.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            ll u = pq.<span class="built_in">top</span>().node;</span><br><span class="line">            pq.<span class="built_in">pop</span>();</span><br><span class="line">            flag[u] = <span class="number">0</span>;</span><br><span class="line">            <span class="built_in">preflowPush</span>(u, s, t);</span><br><span class="line">            <span class="keyword">if</span>(rflow[u]) &#123;</span><br><span class="line">                <span class="comment">// 如果当前节点还有余流</span></span><br><span class="line">                --gap[level[u]];</span><br><span class="line">                <span class="keyword">if</span>(!gap[level[u]]) &#123;</span><br><span class="line">                    <span class="comment">// 断层</span></span><br><span class="line">                    <span class="keyword">for</span>(ll v = <span class="number">1</span>; v &lt;= n; ++v) &#123;</span><br><span class="line">                        <span class="keyword">if</span>(v != s &amp;&amp; v != t &amp;&amp; level[v] &gt; level[u] &amp;&amp; level[v] &lt; n + <span class="number">1</span>) &#123;</span><br><span class="line">                            level[v] = n + <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="built_in">relabel</span>(u, n); <span class="comment">// 重贴标签，提升高度</span></span><br><span class="line">                ++gap[level[u]];</span><br><span class="line">                pq.<span class="built_in">push</span>(depth&#123;u, level[u]&#125;);</span><br><span class="line">                flag[u] = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> rflow[t];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">unordered_map &lt; string, <span class="type">int</span> &gt; ump;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    HLPP hlpp;</span><br><span class="line">    <span class="type">char</span> s[<span class="number">4</span>], t[<span class="number">4</span>];</span><br><span class="line">    <span class="type">int</span> n = <span class="number">1</span>, m = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s%s%d&quot;</span>, s, t, &amp;m);</span><br><span class="line">    ump[s] = n++;</span><br><span class="line">    ump[t] = n++;</span><br><span class="line">    </span><br><span class="line">    hlpp.<span class="built_in">init</span>(MAXN<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = m; i; --i) &#123;</span><br><span class="line">        <span class="type">char</span> ts[<span class="number">4</span>], tv[<span class="number">4</span>];</span><br><span class="line">        <span class="type">int</span> tst, tvt, cap;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s%s%d&quot;</span>, ts, tv, &amp;cap);</span><br><span class="line">        <span class="keyword">if</span>(ump.<span class="built_in">count</span>(ts) == <span class="number">0</span>) &#123;</span><br><span class="line">            ump[ts] = n++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(ump.<span class="built_in">count</span>(tv) == <span class="number">0</span>) &#123;</span><br><span class="line">            ump[tv] = n++;</span><br><span class="line">        &#125;</span><br><span class="line">        tst = ump[ts];</span><br><span class="line">        tvt = ump[tv];</span><br><span class="line">        hlpp.<span class="built_in">addEdge</span>(tst, tvt, cap);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, hlpp.<span class="built_in">maxFlow</span>(ump[s],ump[t],n));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://hotarugali.github.io">hotarugali</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://hotarugali.github.io/2020/08/14/Technique/ACM/%E9%A2%98%E8%A7%A3/PAT%E3%80%8C1003%20Universal%20Travel%20Sites%20(35%E5%88%86)%E3%80%8D/">https://hotarugali.github.io/2020/08/14/Technique/ACM/题解/PAT「1003 Universal Travel Sites (35分)」/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://hotarugali.github.io" target="_blank">お前はどこまで見えている</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Technique/">Technique</a><a class="post-meta__tags" href="/tags/ACM/">ACM</a><a class="post-meta__tags" href="/tags/%E9%A2%98%E8%A7%A3/">题解</a></div><div class="post_share"><div class="social-share" data-image="https://hotarugali.github.io/FigureBed/wallpaper/107.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/donate/WeChatSQ.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/donate/WeChatSQ.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/donate/AliPayQR.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/donate/AliPayQR.png" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/08/14/Technique/ACM/%E7%AE%97%E6%B3%95/%E5%9B%BE%E8%AE%BA/%E7%BD%91%E7%BB%9C%E6%B5%81/%E6%9C%80%E5%A4%A7%E6%B5%81/" title="最大流"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://hotarugali.github.io/FigureBed/wallpaper/628.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">最大流</div></div></a></div><div class="next-post pull-right"><a href="/2020/08/14/Technique/ACM/%E9%A2%98%E8%A7%A3/PAT%E3%80%8C1002%20Business%20(35%E5%88%86)%E3%80%8D/" title="PAT「1002 Business (35分)」"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://hotarugali.github.io/FigureBed/wallpaper/1626.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">PAT「1002 Business (35分)」</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2020/09/08/Technique/ACM/%E9%A2%98%E8%A7%A3/CF1405D%E3%80%8CTree%20Tag%E3%80%8D/" title="CF1405D「Tree Tag」"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://hotarugali.github.io/FigureBed/wallpaper/395.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-09-08</div><div class="title">CF1405D「Tree Tag」</div></div></a></div><div><a href="/2020/09/10/Technique/ACM/%E9%A2%98%E8%A7%A3/CF1407D%E3%80%8CDiscrete%20Centrifugal%20Jumps%E3%80%8D/" title="CF1407D「Discrete Centrifugal Jumps」"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://hotarugali.github.io/FigureBed/wallpaper/441.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-09-10</div><div class="title">CF1407D「Discrete Centrifugal Jumps」</div></div></a></div><div><a href="/2020/09/06/Technique/ACM/%E9%A2%98%E8%A7%A3/CF1409F%E3%80%8CSubsequences%20of%20Length%20Two%E3%80%8D/" title="CF1409F「Subsequences of Length Two」"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://hotarugali.github.io/FigureBed/wallpaper/602.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-09-06</div><div class="title">CF1409F「Subsequences of Length Two」</div></div></a></div><div><a href="/2021/12/13/Technique/ACM/%E9%A2%98%E8%A7%A3/CF1591D%E3%80%8CYet%20Another%20Sorting%20Problem%E3%80%8D/" title="CF1591D「Yet Another Sorting Problem」"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://hotarugali.github.io/FigureBed/wallpaper/798.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-12-13</div><div class="title">CF1591D「Yet Another Sorting Problem」</div></div></a></div><div><a href="/2021/12/14/Technique/ACM/%E9%A2%98%E8%A7%A3/CF1608C%E3%80%8CGame%20Master%E3%80%8D/" title="CF1608C「Game Master」"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://hotarugali.github.io/FigureBed/wallpaper/285.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-12-14</div><div class="title">CF1608C「Game Master」</div></div></a></div><div><a href="/2020/09/09/Technique/ACM/%E9%A2%98%E8%A7%A3/CF991F%E3%80%8CTree%20Destruction%E3%80%8D/" title="CF991F「Tree Destruction」"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://hotarugali.github.io/FigureBed/wallpaper/559.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-09-09</div><div class="title">CF991F「Tree Destruction」</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div id="comment-switch"><span class="first-comment">Waline</span><span class="switch-btn"></span><span class="second-comment">Twikoo</span></div></div><div class="comment-wrap"><div><div id="waline-wrap"></div></div><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E9%A2%98%E7%9B%AE"><span class="toc-text">1. 题目</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Description"><span class="toc-text">Description</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Input-Specification"><span class="toc-text">Input Specification:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Output-Specification"><span class="toc-text">Output Specification:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Sample-Input"><span class="toc-text">Sample Input:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Sample-Output"><span class="toc-text">Sample Output:</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E9%A2%98%E8%A7%A3"><span class="toc-text">2. 题解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E6%9E%90"><span class="toc-text">分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81"><span class="toc-text">代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%99%84%E5%BD%95"><span class="toc-text">附录</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Dinic-%E7%AE%97%E6%B3%95"><span class="toc-text">Dinic 算法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ISAP-%E7%AE%97%E6%B3%95"><span class="toc-text">ISAP 算法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HLPP-%E7%AE%97%E6%B3%95"><span class="toc-text">HLPP 算法</span></a></li></ol></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url('https://hotarugali.github.io/FigureBed/wallpaper/107.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By hotarugali</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, Welcome to my blog.</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="聊天"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex/dist/contrib/copy-tex.min.js"></script><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', { class: 'katex-wrap'})
  })
})()</script><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    btf.addModeChange('mermaid', () => {
      window.runMermaid()
    })

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script><script>function loadWaline () {
  function initWaline () {
    const waline = Waline.init(Object.assign({
      el: '#waline-wrap',
      serverURL: 'https://waline-v2-hotarugali.vercel.app',
      pageview: false,
      dark: 'html[data-theme="dark"]',
      path: window.location.pathname,
      comment: false,
    }, {"locale":{"placeholder":"都看到这里了，留个脚印再走呗~"},"emoji":["https://cdn.jsdelivr.net/gh/hotarugali/Emoji@bilibili_tv_gif/waline/bilibili_tv_gif","https://cdn.jsdelivr.net/gh/hotarugali/Emoji@bilibiliHotKey/waline/bilibiliHotKey","https://cdn.jsdelivr.net/gh/hotarugali/Emoji@bilibili2233/waline/bilibili2233","https://cdn.jsdelivr.net/gh/hotarugali/Emoji@smallshake/waline/smallshake","https://cdn.jsdelivr.net/gh/hotarugali/Emoji@alu/waline/alu","https://cdn.jsdelivr.net/gh/hotarugali/Emoji@QQ/waline/QQ","https://cdn.jsdelivr.net/gh/hotarugali/Emoji@Tieba-New/waline/Tieba-New","https://cdn.jsdelivr.net/gh/hotarugali/Emoji@weibo/waline/weibo"]}))
  }

  const walineCSSLoad = document.getElementById('waline-css')

  if (typeof Waline === 'object') {
    walineCSSLoad ? initWaline() : getCSS('https://cdn.jsdelivr.net/npm/@waline/client/dist/waline.min.css','waline-css').then(initWaline)
  }
  else {
    getCSS('https://cdn.jsdelivr.net/npm/@waline/client/dist/waline.min.css','waline-css').then(() => {
      getScript('https://cdn.jsdelivr.net/npm/@waline/client/dist/waline.min.js').then(initWaline)
    })
  }
}

if ('Waline' === 'Waline' || !true) {
  if (true) btf.loadComment(document.getElementById('waline-wrap'),loadWaline)
  else setTimeout(loadWaline, 0)
} else {
  function loadOtherComment () {
    loadWaline()
  }
}</script><script>(()=>{
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://twikoo-git-main-hotarugali.vercel.app/',
      region: 'ap-guangzhou',
      onCommentLoaded: function () {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://twikoo-git-main-hotarugali.vercel.app/',
      region: 'ap-guangzhou',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      countELement.textContent = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const runFn = () => {
    init()
    GLOBAL_CONFIG_SITE.isPost && getCount()
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') {
      setTimeout(runFn,0)
      return
    } 
    getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(runFn)
  }

  if ('Waline' === 'Twikoo' || !true) {
    if (true) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><div class="aplayer no-destroy" data-id="3107777185" data-server="netease" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="auto" data-autoplay="false" muted></div><script src="https://cdn.jsdelivr.net/npm/vue@2.6.11"></script><script defer src="/live2d-widget/autoload.js"></script><div class="app-refresh" id="app-refresh"> <div class="app-refresh-wrap"> <label>✨ 網站已更新最新版本 👉</label> <a href="javascript:void(0)" onclick="location.reload()">點擊刷新</a> </div></div><script>function showNotification(){if(GLOBAL_CONFIG.Snackbar){var t="light"===document.documentElement.getAttribute("data-theme")?GLOBAL_CONFIG.Snackbar.bgLight:GLOBAL_CONFIG.Snackbar.bgDark,e=GLOBAL_CONFIG.Snackbar.position;Snackbar.show({text:"已更新最新版本",backgroundColor:t,duration:5e5,pos:e,actionText:"點擊刷新",actionTextColor:"#fff",onActionClick:function(t){location.reload()}})}else{var o=`top: 0; background: ${"light"===document.documentElement.getAttribute("data-theme")?"#49b1f5":"#1f1f1f"};`;document.getElementById("app-refresh").style.cssText=o}}"serviceWorker"in navigator&&(navigator.serviceWorker.controller&&navigator.serviceWorker.addEventListener("controllerchange",function(){showNotification()}),window.addEventListener("load",function(){navigator.serviceWorker.register("/sw.js")}));</script><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script src="//code.tidio.co/p6xsdfucuppqybcfijot1hsnancsqec5.js" async="async"></script><script>function onTidioChatApiReady() {
  window.tidioChatApi.hide();
  window.tidioChatApi.on("close", function() {
    window.tidioChatApi.hide();
  });
}
if (window.tidioChatApi) {
  window.tidioChatApi.on("ready", onTidioChatApiReady);
} else {
  document.addEventListener("tidioChat-ready", onTidioChatApiReady);
}

var chatBtnFn = () => {
  document.getElementById("chat_btn").addEventListener("click", function(){
    window.tidioChatApi.show();
    window.tidioChatApi.open();
  });
}
chatBtnFn()
</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div><!-- hexo injector body_end start -->
  <script data-pjax src="/js/githubcalendar.js"></script>
  <script data-pjax>
        function GithubCalendarConfig(){
            var git_githubapiurl ="https://python-github-calendar-api-hotarugali.vercel.app/api?hotarugali";
            var git_color =['#ebedf0', '#fdcdec', '#fc9bd9', '#fa6ac5', '#f838b2', '#f5089f', '#c4067e', '#92055e', '#540336', '#48022f', '#30021f'];
            var git_user ="hotarugali";
            var parent_div_git = document.getElementById('recent-posts');
            var git_div_html = '<div class="recent-post-item" style="width:100%;height:auto;padding:10px;"><div id="github_loading" style="width:10%;height:100%;margin:0 auto;display: block"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animateTransform></path></svg></div><div id="github_container"></div></div>';
            if(parent_div_git && location.pathname =='/'){
                console.log('已挂载github calendar')
                // parent_div_git.innerHTML=git_div_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)
                parent_div_git.insertAdjacentHTML("afterbegin",git_div_html) // 有报错，但不影响使用(支持pjax跳转)
            };
            GithubCalendar(git_githubapiurl,git_color,git_user)
        }
        if(document.getElementById('recent-posts')){
            GithubCalendarConfig()
        }
    </script>
    <style>#github_container{min-height:280px}@media screen and (max-width:650px) {#github_container{background-image:;min-height:0px}}</style>
    <style></style><script data-pjax>function history_calendar_injector_config(){
                var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
                var item_html = '<div class="card-widget card-history"><div class="card-content"><div class="item-headline"><i class="fas fa-clock fa-spin"></i><span>那年今日</span></div><div id="history-baidu" style="height: 100px;overflow: hidden"><div class="history_swiper-container" id="history-container" style="width: 100%;height: 100%"><div class="swiper-wrapper" id="history_container_wrapper" style="height:20px"></div></div></div></div>';
                console.log('已挂载history_calendar')
                // parent_div_git.innerHTML=item_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)
                parent_div_git.insertAdjacentHTML("afterbegin",item_html) // 有报错，但不影响使用(支持pjax跳转)
            }if( document.getElementsByClassName('sticky_layout')[0] && (location.pathname ==='/'|| '/' ==='all')){

            history_calendar_injector_config()
        } </script><script data-pjax  src="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.js"></script><script data-pjax src="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-card-history/baiduhistory/js/main.js"></script><script data-pjax>function electric_clock_injector_config(){
                var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
                var item_html = '<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img id="card-clock-loading" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/npm/hexo-electric-clock-plus@latest/images/weather/loading.gif" style="height: 136px; width: 100%;" data-ll-status="loading" class="entered loading"></div></div></div></div></div>';
                console.log('已挂载electric_clock')
                // parent_div_git.innerHTML=item_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)
                parent_div_git.insertAdjacentHTML("afterbegin",item_html) // 有报错，但不影响使用(支持pjax跳转)
            }if( document.getElementsByClassName('sticky_layout')[0] && (location.pathname ==='/'|| '/' ==='all')){

            electric_clock_injector_config()
        } </script><script src="https://pv.sohu.com/cityjson?ie=utf-8"></script><script data-pjax  src="https://cdn.jsdelivr.net/gh/Zfour/hexo-electric-clock@1.0.6/clock.js"></script><script type="text/javascript">var font='UnidreamLED'</script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script>
        <script type="text/javascript">
            loc = $.ajax({
                    url: "https://ipapi.co/json/",  //json文件位置，文件名
                    type: "GET",                    //请求方式为get
                    dataType: "json",               //返回数据格式为json
                    async: false,
                    success: function(data) {       //请求成功完成后要执行的方法 
                    }
                });
            ip=$.parseJSON(loc.responseText).ip;
            version=$.parseJSON(loc.responseText).version;
            city=$.parseJSON(loc.responseText).city;
            country=$.parseJSON(loc.responseText).country_name;
        </script>
        <script data-pjax src="https://cdn.jsdelivr.net/npm/hexo-electric-clock-plus@latest/js/clock.js"></script><!-- hexo injector body_end end --><script src="/js/markmap.js"></script></body></html>